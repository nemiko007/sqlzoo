# スコットランドの議席数

**テーブル構造:** `ge(id, lastName, firstName, constituency, party, votes, yr)`

2017年のスコットランド（S%）における政党別の獲得議席数を表示
```sql
SELECT party, COUNT(1) FROM (
  SELECT constituency, party, RANK() OVER (PARTITION BY constituency ORDER BY votes DESC) AS posn FROM ge 
  WHERE constituency LIKE 'S%' AND yr = 2017
) AS ed 
WHERE posn = 1 
GROUP BY party
```

---
